!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).uzip={})}(void 0,(function(e){function r(e,r,t){for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[r+o]);return n}function t(e){return e.length<2?"0"+e:e}var n={readUshort:function(e,r){return e[r]|e[r+1]<<8},writeUshort:function(e,r,t){e[r]=255&t,e[r+1]=t>>8&255},readUint:function(e,r){return 16777216*e[r+3]+(e[r+2]<<16|e[r+1]<<8|e[r])},writeUint:function(e,r,t){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},readASCII:r,writeASCII:function(e,r,t){for(var n=0;n<t.length;n++)e[r+n]=t.charCodeAt(n)},pad:t,readUTF8:function(e,n,o){for(var a,f="",i=0;i<o;i++)f+="%"+t(e[n+i].toString(16));try{a=decodeURIComponent(f)}catch(t){return r(e,n,o)}return a},writeUTF8:function(e,r,t){for(var n=t.length,o=0,a=0;a<n;a++){var f=t.charCodeAt(a);if(0==(4294967168&f))e[r+o]=f,o++;else if(0==(4294965248&f))e[r+o]=192|f>>6,e[r+o+1]=128|f>>0&63,o+=2;else if(0==(4294901760&f))e[r+o]=224|f>>12,e[r+o+1]=128|f>>6&63,e[r+o+2]=128|f>>0&63,o+=3;else{if(0!=(4292870144&f))throw"e";e[r+o]=240|f>>18,e[r+o+1]=128|f>>12&63,e[r+o+2]=128|f>>6&63,e[r+o+3]=128|f>>0&63,o+=4}}return o},sizeUTF8:function(e){for(var r=e.length,t=0,n=0;n<r;n++){var o=e.charCodeAt(n);if(0==(4294967168&o))t++;else if(0==(4294965248&o))t+=2;else if(0==(4294901760&o))t+=3;else{if(0!=(4292870144&o))throw"e";t+=4}}return t}};function o(e,r){for(var t=e.length;2!=t&&0==e[t-1];)t-=2;for(var n=0;n<t;n+=2){var o=e[n+1],a=n+3<t?e[n+3]:-1,f=n+5<t?e[n+5]:-1,i=0==n?-1:e[n-1];if(0==o&&a==o&&f==o){for(var l=n+5;l+2<t&&e[l+2]==o;)l+=2;(c=Math.min(l+1-n>>>1,138))<11?r.push(17,c-3):r.push(18,c-11),n+=2*c-2}else if(o==i&&a==o&&f==o){for(l=n+5;l+2<t&&e[l+2]==o;)l+=2;var c=Math.min(l+1-n>>>1,6);r.push(16,c-3),n+=2*c-2}else r.push(o,0)}return t>>>1}function a(e,r,t){var n=[],o=e.length,a=r.length,l=0;for(l=0;l<a;l+=2)r[l]=0,r[l+1]=0;for(l=0;l<o;l++)0!=e[l]&&n.push({lit:l,f:e[l]});var c=n.length,d=n.slice(0);if(0==c)return 0;if(1==c){var u=n[0].lit;d=0==u?1:0;return r[1+(u<<1)]=1,r[1+(d<<1)]=1,1}n.sort((function(e,r){return e.f-r.f}));var s=n[0],v=n[1],h=0,p=1,g=2;for(n[0]={lit:-1,f:s.f+v.f,l:s,r:v,d:0};p!=c-1;)s=h!=p&&(g==c||n[h].f<n[g].f)?n[h++]:n[g++],v=h!=p&&(g==c||n[h].f<n[g].f)?n[h++]:n[g++],n[p++]={lit:-1,f:s.f+v.f,l:s,r:v};var w=f(n[p-1],0);for(w>t&&(i(d,t,w),w=t),l=0;l<c;l++)r[1+(d[l].lit<<1)]=d[l].d;return w}function f(e,r){return-1!=e.lit?(e.d=r,r):Math.max(f(e.l,r+1),f(e.r,r+1))}function i(e,r,t){var n=0,o=1<<t-r,a=0;for(e.sort((function(e,r){return r.d==e.d?e.f-r.f:r.d-e.d})),n=0;n<e.length&&e[n].d>r;n++){var f=e[n].d;e[n].d=r,a+=o-(1<<t-f)}for(a>>>=t-r;a>0;){(f=e[n].d)<r?(e[n].d++,a-=1<<r-f-1):n++}for(;n>=0;n--)e[n].d==r&&a<0&&(e[n].d--,a++);0!=a&&console.log("debt left")}function l(e,r){var t=e.length;if(r<=t)return e;var n=new Uint8Array(Math.max(t<<1,r));return n.set(e,0),n}function c(e,r,t,n,o,a){for(var f=h,i=g,l=0;l<t;){var c=e[i(n,o)&r];o+=15&c;var d=c>>>4;if(d<=15)a[l]=d,l++;else{var u=0,s=0;16==d?(s=3+f(n,o,2),o+=2,u=a[l-1]):17==d?(s=3+f(n,o,3),o+=3):18==d&&(s=11+f(n,o,7),o+=7);for(var v=l+s;l<v;)a[l]=u,l++}}return o}function d(e,r,t,n){for(var o=0,a=0,f=n.length>>>1;a<t;){var i=e[a+r];n[a<<1]=0,n[1+(a<<1)]=i,i>o&&(o=i),a++}for(;a<f;)n[a<<1]=0,n[1+(a<<1)]=0,a++;return o}function u(e,r){for(var t,n,o,a,f=e.length,i=w.bl_count,l=0;l<=r;l++)i[l]=0;for(l=1;l<f;l+=2)i[e[l]]++;var c=w.next_code;for(t=0,i[0]=0,n=1;n<=r;n++)t=t+i[n-1]<<1,c[n]=t;for(o=0;o<f;o+=2)0!=(a=e[o+1])&&(e[o]=c[a],c[a]++)}function s(e,r,t){for(var n=e.length,o=w.rev15,a=0;a<n;a+=2)if(0!=e[a+1])for(var f=a>>1,i=e[a+1],l=f<<4|i,c=r-i,d=e[a]<<c,u=d+(1<<c);d!=u;){t[o[d]>>>15-r]=l,d++}}function v(e,r){for(var t=w.rev15,n=15-r,o=0;o<e.length;o+=2){var a=e[o]<<r-e[o+1];e[o]=t[a]>>>n}}function h(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8)>>>(7&r)&(1<<t)-1}function p(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)&(1<<t)-1}function g(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)}const w=(b=Uint16Array,m=Uint32Array,{next_code:new b(16),bl_count:new b(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new b(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new m(32),flmap:new b(512),fltree:[],fdmap:new b(32),fdtree:[],lmap:new b(32768),ltree:[],ttree:[],dmap:new b(32768),dtree:[],imap:new b(512),itree:[],rev15:new b(32768),lhst:new m(286),dhst:new m(30),ihst:new m(19),lits:new m(15e3),strt:new b(65536),prev:new b(32768)});var b,m;!function(){for(var e=0;e<32768;e++){var r=e;r=(4278255360&(r=(4042322160&(r=(3435973836&(r=(2863311530&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8,w.rev15[e]=(r>>>16|r<<16)>>>17}function t(e,r,t){for(;0!=r--;)e.push(0,t)}for(e=0;e<32;e++)w.ldef[e]=w.of0[e]<<3|w.exb[e],w.ddef[e]=w.df0[e]<<4|w.dxb[e];t(w.fltree,144,8),t(w.fltree,112,9),t(w.fltree,24,7),t(w.fltree,8,8),u(w.fltree,9),s(w.fltree,9,w.flmap),v(w.fltree,9),t(w.fdtree,32,5),u(w.fdtree,5),s(w.fdtree,5,w.fdmap),v(w.fdtree,5),t(w.itree,19,0),t(w.ltree,286,0),t(w.dtree,30,0),t(w.ttree,320,0)}();var y={getTrees:function(){for(var e=a(w.lhst,w.ltree,15),r=a(w.dhst,w.dtree,15),t=[],n=o(w.ltree,t),f=[],i=o(w.dtree,f),l=0;l<t.length;l+=2)w.ihst[t[l]]++;for(l=0;l<f.length;l+=2)w.ihst[f[l]]++;for(var c=a(w.ihst,w.itree,7),d=19;d>4&&0==w.itree[1+(w.ordr[d-1]<<1)];)d--;return[e,r,c,n,i,d,t,f]},getSecond:function(e){for(var r=[],t=0;t<e.length;t+=2)r.push(e[t+1]);return r},nonZero:function(e){for(var r="",t=0;t<e.length;t+=2)0!=e[t+1]&&(r+=(t>>1)+",");return r},contSize:function(e,r){for(var t=0,n=0;n<r.length;n++)t+=r[n]*e[1+(n<<1)];return t},setDepth:f,restrictDepth:i,inflate:function(e,r){var t=Uint8Array;if(3==e[0]&&0==e[1])return r||new t(0);var n=p,o=h,a=c,f=g,i=null==r;i&&(r=new t(e.length>>>2<<3));for(var v,b,m=0,y=0,U=0,A=0,x=0,C=0,z=0,T=0,k=0;0==m;)if(m=n(e,k,1),y=n(e,k+1,2),k+=3,0!=y){if(i&&(r=l(r,T+(1<<17))),1==y&&(v=w.flmap,b=w.fdmap,C=511,z=31),2==y){U=o(e,k,5)+257,A=o(e,k+5,5)+1,x=o(e,k+10,4)+4,k+=14;for(var R=0;R<38;R+=2)w.itree[R]=0,w.itree[R+1]=0;var I=1;for(R=0;R<x;R++){var F=o(e,k+3*R,3);w.itree[1+(w.ordr[R]<<1)]=F,F>I&&(I=F)}k+=3*x,u(w.itree,I),s(w.itree,I,w.imap),v=w.lmap,b=w.dmap,k=a(w.imap,(1<<I)-1,U+A,e,k,w.ttree);var M=d(w.ttree,0,U,w.ltree);C=(1<<M)-1;var S=d(w.ttree,U,A,w.dtree);z=(1<<S)-1,u(w.ltree,M),s(w.ltree,M,v),u(w.dtree,S),s(w.dtree,S,b)}for(;;){var E=v[f(e,k)&C];k+=15&E;var L=E>>>4;if(L>>>8==0)r[T++]=L;else{if(256==L)break;var O=T+L-254;if(L>264){var _=w.ldef[L-257];O=T+(_>>>3)+o(e,k,7&_),k+=7&_}var j=b[f(e,k)&z];k+=15&j;var B=j>>>4,D=w.ddef[B],H=(D>>>4)+n(e,k,15&D);for(k+=15&D;T<O;)r[T]=r[T++-H],r[T]=r[T++-H],r[T]=r[T++-H],r[T]=r[T++-H];T=O}}}else{0!=(7&k)&&(k+=8-(7&k));var P=4+(k>>>3),Z=e[P-4]|e[P-3]<<8;i&&(r=l(r,T+Z)),r.set(new t(e.buffer,e.byteOffset+P,Z),T),k=P+Z<<3,T+=Z}return r.length==T?r:r.slice(0,T)},codes2map:s,revCodes:v,U:w};const U={table:function(){for(var e=new Uint32Array(256),r=0;r<256;r++){for(var t=r,n=0;n<8;n++)1&t?t=3988292384^t>>>1:t>>>=1;e[r]=t}return e}(),update:function(e,r,t,n){for(var o=0;o<n;o++)e=U.table[255&(e^r[t+o])]^e>>>8;return e},crc:function(e,r,t){return 4294967295^U.update(4294967295,e,r,t)}};function A(e,r){for(var t=n.readUshort,o=n.readUint,a=0,f={},i=new Uint8Array(e),l=i.length-4;101010256!=o(i,l);)l--;a=l;a+=4;var c=t(i,a+=4),d=(t(i,a+=2),o(i,a+=2)),u=o(i,a+=4);a+=4,a=u;for(var s=0;s<c;s++){o(i,a);a+=4,a+=4,a+=4;o(i,a+=4),d=o(i,a+=4);var v=o(i,a+=4),h=t(i,a+=4),p=t(i,a+2),g=t(i,a+4);a+=6;var w=o(i,a+=8);a+=4,a+=h+p+g,x(i,w,f,d,v,r)}return f}function x(e,r,t,o,a,f){var i=n.readUshort,l=n.readUint,c=(l(e,r),i(e,r+=4),i(e,r+=2),i(e,r+=2));l(e,r+=2),l(e,r+=4);r+=4;var d=i(e,r+=8),u=i(e,r+=2);r+=2;var s=n.readUTF8(e,r,d);if(r+=d,r+=u,f)t[s]={size:a,csize:o};else{var v=new Uint8Array(e.buffer,r);if(0==c)t[s]=new Uint8Array(v.buffer.slice(r,r+o));else{if(8!=c)throw"unknown compression method: "+c;var h=new Uint8Array(a);C(v,h),t[s]=h}}}function C(e,r){return y.inflate(e,r)}function z(e,r){e[0],e[1];return C(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),r)}function T(e,r){null==r&&(r={level:6});var t=new Uint8Array(50+Math.floor(1.1*e.length)),n=y.deflateRaw(e,t,n,r.level);return new Uint8Array(t.buffer,0,n)}function k(e){var r,t=0,o=n.writeUint,a=n.writeUshort,f={};for(var i in e){var l=(r=void 0,r=i.split(".").pop().toLowerCase(),!(-1!="png,jpg,jpeg,zip".indexOf(r))),c=e[i],d=U.crc(c,0,c.length);f[i]={cpr:l,usize:c.length,crc:d,file:l?T(c):c}}for(var i in f)t+=f[i].file.length+30+46+2*n.sizeUTF8(i);t+=22;var u=new Uint8Array(t),s=0,v=[];for(var i in f){var h=f[i];v.push(s),s=R(u,s,i,h,0)}var p=0,g=s;for(var i in f){h=f[i];v.push(s),s=R(u,s,i,h,1,v[p++])}var w=s-g;return o(u,s,101010256),s+=4,a(u,s+=4,p),a(u,s+=2,p),o(u,s+=2,w),o(u,s+=4,g),s+=4,s+=2,u.buffer}function R(e,r,t,o,a,f){var i=n.writeUint,l=n.writeUshort,c=o.file;return i(e,r,0==a?67324752:33639248),r+=4,1==a&&(r+=2),l(e,r,20),l(e,r+=2,0),l(e,r+=2,o.cpr?8:0),i(e,r+=2,0),i(e,r+=4,o.crc),i(e,r+=4,c.length),i(e,r+=4,o.usize),l(e,r+=4,n.sizeUTF8(t)),l(e,r+=2,0),r+=2,1==a&&(r+=2,r+=2,i(e,r+=6,f),r+=4),r+=n.writeUTF8(e,r,t),0==a&&(e.set(c,r),r+=c.length),r}function I(e,r,t){for(var n=1,o=0,a=r,f=r+t;a<f;){for(var i=Math.min(a+5552,f);a<i;)o+=n+=e[a++];n%=65521,o%=65521}return o<<16|n}var F={adler:I,encode:k,inflate:z,inflateRaw:C,parse:A};e.adler=I,e.default=F,e.encode=k,e.inflate=z,e.inflateRaw=C,e.parse=A,Object.defineProperty(e,"__esModule",{value:!0})}));class e{constructor(e,r){this.load(e,r)}abort(){this.reader.cancel()}async load(e,t){let n=await fetch(e);this.reader=n.body.getReader();let o=[],a={url:e,typ:n.headers.get("Content-Type"),len:1*n.headers.get("Content-Length"),enc:n.headers.get("Content-Encoding"),rec:0,dat:!1,start:r()};for(;;){const{done:e,value:r}=await this.reader.read();if(e)break;o.push(r),a.rec+=r.length,a.chunk=r,t&&t(a)}let f=new Uint8Array(a.rec),i=0;for(let e of o)f.set(e,i),i+=e.length;a.dat=f,a.end=r(),a.dur=a.end-a.start,a.bps=8*a.len/a.dur,t&&t(a)}}function r(){return performance.timeOrigin+performance.now()}const t=[];let n;const o={background:!0,fullscreen:!0,abort:e=>{f(e)},loadURL:async(r,n)=>{a();const o=new e(r,(e=>{i(e.chunk,e.rec,e.len,e.enc,e.prot),n&&n(e),e.dat&&f(o)}));t.push(o)}};function a(){if(document.getElementById("copperbars"))return;const e=document.createElement("canvas");e.id="copperbars";const r=o.background?-604:604;e.style="position:absolute;top:0;left:0;width:100%;height:100%;image-rendering:pixelated;z-index:"+r+";",document.getElementById("copperbars")||document.body.appendChild(e),n=e.getContext("2d",{alpha:!o.background})}function f(e){if(e){e.abort();const r=t.indexOf(e);t.splice(r,1)}0===t.length&&document.getElementById("copperbars")&&document.body.removeChild(document.getElementById("copperbars"))}function i(e,r,t,a,f){let i=l(1,200,r/t);"br"===a&&(i=n.canvas.clientHeight/2),"gzip"===a&&(i=n.canvas.clientHeight/3),i>e.length/3&&(i=e.length/3),n.canvas.width=i,n.canvas.height=i;for(let r=0,t=0;r<i;r++){const o="rgb("+e[t++]+", "+e[t++]+", "+e[t++]+")";n.strokeStyle=o,n.beginPath(),n.moveTo(0,r),n.lineTo(i,r),n.stroke()}o.fullscreen||n.clearRect(.05*i,.05*i,.9*i,.9*i)}function l(e,r,t){return(1-t)*e+t*r}const c={background:o.background,fullscreen:o.fullscreen,abort:o.abort,loadURL:async(e,r)=>{o.loadURL(e,(e=>{r&&!e.dat&&r(e),e.dat&&d(e,r)}))}};function d(e,r){if(80===e.dat[0]&&75===e.dat[1])try{e.dat=uzip.parse(Array.from(e.dat))}catch(e){console.error(e)}r&&r(e)}export{c as LDR};