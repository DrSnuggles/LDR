!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).uzip={})}(void 0,(function(e){function r(e,r,t){for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[r+o]);return n}function t(e){return e.length<2?"0"+e:e}var n={readUshort:function(e,r){return e[r]|e[r+1]<<8},writeUshort:function(e,r,t){e[r]=255&t,e[r+1]=t>>8&255},readUint:function(e,r){return 16777216*e[r+3]+(e[r+2]<<16|e[r+1]<<8|e[r])},writeUint:function(e,r,t){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},readASCII:r,writeASCII:function(e,r,t){for(var n=0;n<t.length;n++)e[r+n]=t.charCodeAt(n)},pad:t,readUTF8:function(e,n,o){for(var f,a="",i=0;i<o;i++)a+="%"+t(e[n+i].toString(16));try{f=decodeURIComponent(a)}catch(t){return r(e,n,o)}return f},writeUTF8:function(e,r,t){for(var n=t.length,o=0,f=0;f<n;f++){var a=t.charCodeAt(f);if(0==(4294967168&a))e[r+o]=a,o++;else if(0==(4294965248&a))e[r+o]=192|a>>6,e[r+o+1]=128|a>>0&63,o+=2;else if(0==(4294901760&a))e[r+o]=224|a>>12,e[r+o+1]=128|a>>6&63,e[r+o+2]=128|a>>0&63,o+=3;else{if(0!=(4292870144&a))throw"e";e[r+o]=240|a>>18,e[r+o+1]=128|a>>12&63,e[r+o+2]=128|a>>6&63,e[r+o+3]=128|a>>0&63,o+=4}}return o},sizeUTF8:function(e){for(var r=e.length,t=0,n=0;n<r;n++){var o=e.charCodeAt(n);if(0==(4294967168&o))t++;else if(0==(4294965248&o))t+=2;else if(0==(4294901760&o))t+=3;else{if(0!=(4292870144&o))throw"e";t+=4}}return t}};function o(e,r){for(var t=e.length;2!=t&&0==e[t-1];)t-=2;for(var n=0;n<t;n+=2){var o=e[n+1],f=n+3<t?e[n+3]:-1,a=n+5<t?e[n+5]:-1,i=0==n?-1:e[n-1];if(0==o&&f==o&&a==o){for(var l=n+5;l+2<t&&e[l+2]==o;)l+=2;(u=Math.min(l+1-n>>>1,138))<11?r.push(17,u-3):r.push(18,u-11),n+=2*u-2}else if(o==i&&f==o&&a==o){for(l=n+5;l+2<t&&e[l+2]==o;)l+=2;var u=Math.min(l+1-n>>>1,6);r.push(16,u-3),n+=2*u-2}else r.push(o,0)}return t>>>1}function f(e,r,t){var n=[],o=e.length,f=r.length,l=0;for(l=0;l<f;l+=2)r[l]=0,r[l+1]=0;for(l=0;l<o;l++)0!=e[l]&&n.push({lit:l,f:e[l]});var u=n.length,c=n.slice(0);if(0==u)return 0;if(1==u){var d=n[0].lit;c=0==d?1:0;return r[1+(d<<1)]=1,r[1+(c<<1)]=1,1}n.sort((function(e,r){return e.f-r.f}));var s=n[0],v=n[1],h=0,p=1,g=2;for(n[0]={lit:-1,f:s.f+v.f,l:s,r:v,d:0};p!=u-1;)s=h!=p&&(g==u||n[h].f<n[g].f)?n[h++]:n[g++],v=h!=p&&(g==u||n[h].f<n[g].f)?n[h++]:n[g++],n[p++]={lit:-1,f:s.f+v.f,l:s,r:v};var w=a(n[p-1],0);for(w>t&&(i(c,t,w),w=t),l=0;l<u;l++)r[1+(c[l].lit<<1)]=c[l].d;return w}function a(e,r){return-1!=e.lit?(e.d=r,r):Math.max(a(e.l,r+1),a(e.r,r+1))}function i(e,r,t){var n=0,o=1<<t-r,f=0;for(e.sort((function(e,r){return r.d==e.d?e.f-r.f:r.d-e.d})),n=0;n<e.length&&e[n].d>r;n++){var a=e[n].d;e[n].d=r,f+=o-(1<<t-a)}for(f>>>=t-r;f>0;){(a=e[n].d)<r?(e[n].d++,f-=1<<r-a-1):n++}for(;n>=0;n--)e[n].d==r&&f<0&&(e[n].d--,f++);0!=f&&console.log("debt left")}function l(e,r){var t=e.length;if(r<=t)return e;var n=new Uint8Array(Math.max(t<<1,r));return n.set(e,0),n}function u(e,r,t,n,o,f){for(var a=h,i=g,l=0;l<t;){var u=e[i(n,o)&r];o+=15&u;var c=u>>>4;if(c<=15)f[l]=c,l++;else{var d=0,s=0;16==c?(s=3+a(n,o,2),o+=2,d=f[l-1]):17==c?(s=3+a(n,o,3),o+=3):18==c&&(s=11+a(n,o,7),o+=7);for(var v=l+s;l<v;)f[l]=d,l++}}return o}function c(e,r,t,n){for(var o=0,f=0,a=n.length>>>1;f<t;){var i=e[f+r];n[f<<1]=0,n[1+(f<<1)]=i,i>o&&(o=i),f++}for(;f<a;)n[f<<1]=0,n[1+(f<<1)]=0,f++;return o}function d(e,r){for(var t,n,o,f,a=e.length,i=w.bl_count,l=0;l<=r;l++)i[l]=0;for(l=1;l<a;l+=2)i[e[l]]++;var u=w.next_code;for(t=0,i[0]=0,n=1;n<=r;n++)t=t+i[n-1]<<1,u[n]=t;for(o=0;o<a;o+=2)0!=(f=e[o+1])&&(e[o]=u[f],u[f]++)}function s(e,r,t){for(var n=e.length,o=w.rev15,f=0;f<n;f+=2)if(0!=e[f+1])for(var a=f>>1,i=e[f+1],l=a<<4|i,u=r-i,c=e[f]<<u,d=c+(1<<u);c!=d;){t[o[c]>>>15-r]=l,c++}}function v(e,r){for(var t=w.rev15,n=15-r,o=0;o<e.length;o+=2){var f=e[o]<<r-e[o+1];e[o]=t[f]>>>n}}function h(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8)>>>(7&r)&(1<<t)-1}function p(e,r,t){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)&(1<<t)-1}function g(e,r){return(e[r>>>3]|e[1+(r>>>3)]<<8|e[2+(r>>>3)]<<16)>>>(7&r)}const w=(b=Uint16Array,m=Uint32Array,{next_code:new b(16),bl_count:new b(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new b(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new m(32),flmap:new b(512),fltree:[],fdmap:new b(32),fdtree:[],lmap:new b(32768),ltree:[],ttree:[],dmap:new b(32768),dtree:[],imap:new b(512),itree:[],rev15:new b(32768),lhst:new m(286),dhst:new m(30),ihst:new m(19),lits:new m(15e3),strt:new b(65536),prev:new b(32768)});var b,m;!function(){for(var e=0;e<32768;e++){var r=e;r=(4278255360&(r=(4042322160&(r=(3435973836&(r=(2863311530&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8,w.rev15[e]=(r>>>16|r<<16)>>>17}function t(e,r,t){for(;0!=r--;)e.push(0,t)}for(e=0;e<32;e++)w.ldef[e]=w.of0[e]<<3|w.exb[e],w.ddef[e]=w.df0[e]<<4|w.dxb[e];t(w.fltree,144,8),t(w.fltree,112,9),t(w.fltree,24,7),t(w.fltree,8,8),d(w.fltree,9),s(w.fltree,9,w.flmap),v(w.fltree,9),t(w.fdtree,32,5),d(w.fdtree,5),s(w.fdtree,5,w.fdmap),v(w.fdtree,5),t(w.itree,19,0),t(w.ltree,286,0),t(w.dtree,30,0),t(w.ttree,320,0)}();var U={getTrees:function(){for(var e=f(w.lhst,w.ltree,15),r=f(w.dhst,w.dtree,15),t=[],n=o(w.ltree,t),a=[],i=o(w.dtree,a),l=0;l<t.length;l+=2)w.ihst[t[l]]++;for(l=0;l<a.length;l+=2)w.ihst[a[l]]++;for(var u=f(w.ihst,w.itree,7),c=19;c>4&&0==w.itree[1+(w.ordr[c-1]<<1)];)c--;return[e,r,u,n,i,c,t,a]},getSecond:function(e){for(var r=[],t=0;t<e.length;t+=2)r.push(e[t+1]);return r},nonZero:function(e){for(var r="",t=0;t<e.length;t+=2)0!=e[t+1]&&(r+=(t>>1)+",");return r},contSize:function(e,r){for(var t=0,n=0;n<r.length;n++)t+=r[n]*e[1+(n<<1)];return t},setDepth:a,restrictDepth:i,inflate:function(e,r){var t=Uint8Array;if(3==e[0]&&0==e[1])return r||new t(0);var n=p,o=h,f=u,a=g,i=null==r;i&&(r=new t(e.length>>>2<<3));for(var v,b,m=0,U=0,y=0,A=0,x=0,C=0,z=0,T=0,k=0;0==m;)if(m=n(e,k,1),U=n(e,k+1,2),k+=3,0!=U){if(i&&(r=l(r,T+(1<<17))),1==U&&(v=w.flmap,b=w.fdmap,C=511,z=31),2==U){y=o(e,k,5)+257,A=o(e,k+5,5)+1,x=o(e,k+10,4)+4,k+=14;for(var R=0;R<38;R+=2)w.itree[R]=0,w.itree[R+1]=0;var I=1;for(R=0;R<x;R++){var F=o(e,k+3*R,3);w.itree[1+(w.ordr[R]<<1)]=F,F>I&&(I=F)}k+=3*x,d(w.itree,I),s(w.itree,I,w.imap),v=w.lmap,b=w.dmap,k=f(w.imap,(1<<I)-1,y+A,e,k,w.ttree);var M=c(w.ttree,0,y,w.ltree);C=(1<<M)-1;var S=c(w.ttree,y,A,w.dtree);z=(1<<S)-1,d(w.ltree,M),s(w.ltree,M,v),d(w.dtree,S),s(w.dtree,S,b)}for(;;){var E=v[a(e,k)&C];k+=15&E;var L=E>>>4;if(L>>>8==0)r[T++]=L;else{if(256==L)break;var O=T+L-254;if(L>264){var _=w.ldef[L-257];O=T+(_>>>3)+o(e,k,7&_),k+=7&_}var j=b[a(e,k)&z];k+=15&j;var B=j>>>4,D=w.ddef[B],H=(D>>>4)+n(e,k,15&D);for(k+=15&D;T<O;)r[T]=r[T++-H],r[T]=r[T++-H],r[T]=r[T++-H],r[T]=r[T++-H];T=O}}}else{0!=(7&k)&&(k+=8-(7&k));var P=4+(k>>>3),Z=e[P-4]|e[P-3]<<8;i&&(r=l(r,T+Z)),r.set(new t(e.buffer,e.byteOffset+P,Z),T),k=P+Z<<3,T+=Z}return r.length==T?r:r.slice(0,T)},codes2map:s,revCodes:v,U:w};const y={table:function(){for(var e=new Uint32Array(256),r=0;r<256;r++){for(var t=r,n=0;n<8;n++)1&t?t=3988292384^t>>>1:t>>>=1;e[r]=t}return e}(),update:function(e,r,t,n){for(var o=0;o<n;o++)e=y.table[255&(e^r[t+o])]^e>>>8;return e},crc:function(e,r,t){return 4294967295^y.update(4294967295,e,r,t)}};function A(e,r){for(var t=n.readUshort,o=n.readUint,f=0,a={},i=new Uint8Array(e),l=i.length-4;101010256!=o(i,l);)l--;f=l;f+=4;var u=t(i,f+=4),c=(t(i,f+=2),o(i,f+=2)),d=o(i,f+=4);f+=4,f=d;for(var s=0;s<u;s++){o(i,f);f+=4,f+=4,f+=4;o(i,f+=4),c=o(i,f+=4);var v=o(i,f+=4),h=t(i,f+=4),p=t(i,f+2),g=t(i,f+4);f+=6;var w=o(i,f+=8);f+=4,f+=h+p+g,x(i,w,a,c,v,r)}return a}function x(e,r,t,o,f,a){var i=n.readUshort,l=n.readUint,u=(l(e,r),i(e,r+=4),i(e,r+=2),i(e,r+=2));l(e,r+=2),l(e,r+=4);r+=4;var c=i(e,r+=8),d=i(e,r+=2);r+=2;var s=n.readUTF8(e,r,c);if(r+=c,r+=d,a)t[s]={size:f,csize:o};else{var v=new Uint8Array(e.buffer,r);if(0==u)t[s]=new Uint8Array(v.buffer.slice(r,r+o));else{if(8!=u)throw"unknown compression method: "+u;var h=new Uint8Array(f);C(v,h),t[s]=h}}}function C(e,r){return U.inflate(e,r)}function z(e,r){e[0],e[1];return C(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),r)}function T(e,r){null==r&&(r={level:6});var t=new Uint8Array(50+Math.floor(1.1*e.length)),n=U.deflateRaw(e,t,n,r.level);return new Uint8Array(t.buffer,0,n)}function k(e){var r,t=0,o=n.writeUint,f=n.writeUshort,a={};for(var i in e){var l=(r=void 0,r=i.split(".").pop().toLowerCase(),!(-1!="png,jpg,jpeg,zip".indexOf(r))),u=e[i],c=y.crc(u,0,u.length);a[i]={cpr:l,usize:u.length,crc:c,file:l?T(u):u}}for(var i in a)t+=a[i].file.length+30+46+2*n.sizeUTF8(i);t+=22;var d=new Uint8Array(t),s=0,v=[];for(var i in a){var h=a[i];v.push(s),s=R(d,s,i,h,0)}var p=0,g=s;for(var i in a){h=a[i];v.push(s),s=R(d,s,i,h,1,v[p++])}var w=s-g;return o(d,s,101010256),s+=4,f(d,s+=4,p),f(d,s+=2,p),o(d,s+=2,w),o(d,s+=4,g),s+=4,s+=2,d.buffer}function R(e,r,t,o,f,a){var i=n.writeUint,l=n.writeUshort,u=o.file;return i(e,r,0==f?67324752:33639248),r+=4,1==f&&(r+=2),l(e,r,20),l(e,r+=2,0),l(e,r+=2,o.cpr?8:0),i(e,r+=2,0),i(e,r+=4,o.crc),i(e,r+=4,u.length),i(e,r+=4,o.usize),l(e,r+=4,n.sizeUTF8(t)),l(e,r+=2,0),r+=2,1==f&&(r+=2,r+=2,i(e,r+=6,a),r+=4),r+=n.writeUTF8(e,r,t),0==f&&(e.set(u,r),r+=u.length),r}function I(e,r,t){for(var n=1,o=0,f=r,a=r+t;f<a;){for(var i=Math.min(f+5552,a);f<i;)o+=n+=e[f++];n%=65521,o%=65521}return o<<16|n}var F={adler:I,encode:k,inflate:z,inflateRaw:C,parse:A};e.adler=I,e.default=F,e.encode=k,e.inflate=z,e.inflateRaw=C,e.parse=A,Object.defineProperty(e,"__esModule",{value:!0})}));const e=[];let r;const t={background:!0,fullscreen:!0,abort:e=>{o(e)},loadURL:async(r,t)=>{n();let a=await fetch(r);const l=a.body.getReader();e.push(l);let u=[],c={url:r,typ:a.headers.get("Content-Type"),len:1*a.headers.get("Content-Length"),enc:a.headers.get("Content-Encoding"),rec:0,dat:!1,start:i()};for(;;){const{done:e,value:r}=await l.read();if(e)break;u.push(r),c.rec+=r.length,f(r,c.rec,c.len,c.enc),t&&t(c)}let d=new Uint8Array(c.rec),s=0;for(let e of u)d.set(e,s),s+=e.length;c.dat=d,c.end=i(),c.dur=c.end-c.start,c.bps=8*c.len/c.dur,o(l),t&&t(c)}};function n(){if(document.getElementById("copperbars"))return;const e=document.createElement("canvas");e.id="copperbars";const n=t.background?-604:604;e.style="position:absolute;top:0;left:0;width:100%;height:100%;image-rendering:pixelated;z-index:"+n+";",document.getElementById("copperbars")||document.body.appendChild(e),r=e.getContext("2d",{alpha:!t.background})}function o(r){if(r){r.cancel();const t=e.indexOf(r);e.splice(t,1)}0===e.length&&document.getElementById("copperbars")&&document.body.removeChild(document.getElementById("copperbars"))}function f(e,n,o,f,i){let l=a(1,200,n/o);"br"===f&&(l=r.canvas.clientHeight/2),"gzip"===f&&(l=r.canvas.clientHeight/3),l>e.length/3&&(l=e.length/3),r.canvas.width=l,r.canvas.height=l;for(let t=0,n=0;t<l;t++){const o="rgb("+e[n++]+", "+e[n++]+", "+e[n++]+")";r.strokeStyle=o,r.beginPath(),r.moveTo(0,t),r.lineTo(l,t),r.stroke()}t.fullscreen||r.clearRect(.05*l,.05*l,.9*l,.9*l)}function a(e,r,t){return(1-t)*e+t*r}function i(){return performance.timeOrigin+performance.now()}const l={background:t.background,fullscreen:t.fullscreen,abort:t.abort,loadURL:async(e,r)=>{t.loadURL(e,(e=>{r&&!e.dat&&r(e),e.dat&&u(e,r)}))}};function u(e,r){if(80===e.dat[0]&&75===e.dat[1])try{e.dat=uzip.parse(Array.from(e.dat))}catch(e){console.error(e)}r&&r(e)}export{l as LDR};