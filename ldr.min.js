const e=[];let t;const n={background:!0,fullscreen:!0,abort:e=>{r(e)},loadURL:async(t,n)=>{o();let a=await fetch(t);const l=a.body.getReader();e.push(l);let i=[],s={url:t,typ:a.headers.get("Content-Type"),len:1*a.headers.get("Content-Length"),enc:a.headers.get("Content-Encoding"),rec:0,dat:!1,start:d()};for(;;){const{done:e,value:t}=await l.read();if(e)break;i.push(t),s.rec+=t.length,c(t,s.rec,s.len,s.enc),n&&n(s)}let g=new Uint8Array(s.rec),u=0;for(let e of i)g.set(e,u),u+=e.length;s.dat=g,s.end=d(),s.dur=s.end-s.start,s.bps=8*s.len/s.dur,r(l),n&&n(s)}};function o(){if(document.getElementById("copperbars"))return;const e=document.createElement("canvas");e.id="copperbars";const o=n.background?-604:604;e.style="position:absolute;top:0;left:0;width:100%;height:100%;image-rendering:pixelated;z-index:"+o+";",document.getElementById("copperbars")||document.body.appendChild(e),t=e.getContext("2d",{alpha:!n.background})}function r(t){if(t){t.cancel();const n=e.indexOf(t);e.splice(n,1)}0===e.length&&document.getElementById("copperbars")&&document.body.removeChild(document.getElementById("copperbars"))}function c(e,o,r,c,d){let l=a(1,200,o/r);"br"===c&&(l=t.canvas.clientHeight/2),"gzip"===c&&(l=t.canvas.clientHeight/3),l>e.length/3&&(l=e.length/3),t.canvas.width=l,t.canvas.height=l;for(let n=0,o=0;n<l;n++){const r="rgb("+e[o++]+", "+e[o++]+", "+e[o++]+")";t.strokeStyle=r,t.beginPath(),t.moveTo(0,n),t.lineTo(l,n),t.stroke()}n.fullscreen||t.clearRect(.05*l,.05*l,.9*l,.9*l)}function a(e,t,n){return(1-n)*e+n*t}function d(){return performance.timeOrigin+performance.now()}export{n as LDR};